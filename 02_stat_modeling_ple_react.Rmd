---
title: "02_stat_modeling_ple_react"
author: "Levente Ronai"
output: html_document
  html_document:
   theme: spacelab
   code_download: true
   toc: true
   toc_float: true
editor_options: 
  chunk_output_type: inline
---

```{r, include=F}

options(scipen = 999)

suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(xts))
suppressPackageStartupMessages(library(psych))
suppressPackageStartupMessages(library(qgraph))
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(purrr))
suppressPackageStartupMessages(library(lme4))
suppressPackageStartupMessages(library(lmerTest))
suppressPackageStartupMessages(library(sjPlot))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(car))
suppressPackageStartupMessages(library(broom))
suppressPackageStartupMessages(library(performance))
suppressPackageStartupMessages(library(lmeresampler))

```

import data

```{r}
dat_cleaned <- read_csv("data_processed/dat_cleaned.csv")

model_dat_stressors <- read.csv("data_processed/model_dat_stressors.csv")
```


```{r}

model_dat <- 
  model_dat_stressors  %>% 
  mutate(stressor_higher = stressor_higher * -1,
         stress_balance_cfa = stress_balance_cfa * -1,
         stress_social_cfa = stress_social_cfa * -1,
         stress_control_cfa = stress_control_cfa * -1) # the higher the value, the greater the exposure to stress

```

### ~ ple

```{r}
m0 <- 
  lmer(
    ple_cfa ~ 
      day + beep + gender + age + stressor_higher + (stressor_higher | id_esm), data = model_dat)


m1 <- 
  lmer(
    ple_cfa ~ 
      day + beep + gender + age +
      stressor_higher * mss_neg_score  +
 #     stressor_higher * mss_pos_score  +
 #     stressor_higher * mss_dis_score  +
      (stressor_higher | id_esm), data = model_dat)

m2 <- 
  lmer(
    ple_cfa ~ 
      day + beep + gender + age +
      stressor_higher * mss_neg_score  +
      stressor_higher * mss_pos_score  +
 #     stressor_higher * mss_dis_score  +
      (stressor_higher | id_esm), data = model_dat)

m3 <- 
  lmer(
    ple_cfa ~ 
      day + beep + gender + age +
      stressor_higher * mss_neg_score  +
      stressor_higher * mss_pos_score  +
      stressor_higher * mss_dis_score  +
      (stressor_higher | id_esm), data = model_dat)

m4 <-
  lmer(
    ple_cfa ~
      day + beep + gender + age +
     # stressor_higher * mss_neg_score  +
     # stressor_higher * mss_pos_score  +
      stressor_higher * mss_dis_score  +
      (stressor_higher | id_esm), data = model_dat)


m5 <-
  lmer(
    ple_cfa ~
      day + beep + gender + age +
     # stressor_higher * mss_neg_score  +
      stressor_higher * mss_pos_score  +
     # stressor_higher * mss_dis_score  +
      (stressor_higher | id_esm), data = model_dat)


tab_model(m0, m1, m2, 
          m3, m4, m5,
          show.aicc = T, show.std = T)

saveRDS(m0, "models/m0.rds")
saveRDS(m1, "models/m1.rds")
saveRDS(m2, "models/m2.rds")
saveRDS(m3, "models/m3.rds")
saveRDS(m4, "models/m4.rds")
saveRDS(m5, "models/m5.rds")

```

```{r}
plot_model(m3, type = "diag")
vif(m3)
```

### ~ event unpleasantness

```{r}

m6 <-  
  lmer(
     event_unpleasantness ~ 
      day + beep + gender + age +
      stressor_higher + 
      (stressor_higher | id_esm), data = model_dat)

m7 <- 
  lmer(
     event_unpleasantness ~ 
      day + beep + gender + age +
      stressor_higher * mss_neg_score +
     # stressor_higher * mss_pos_score +
      #stressor_higher * mss_dis_score + 
      (stressor_higher | id_esm), data = model_dat)


m8 <- 
  lmer(
     event_unpleasantness ~ 
      day + beep + gender + age +
      stressor_higher * mss_neg_score +
      stressor_higher * mss_pos_score +
      stressor_higher * mss_dis_score + 
      (stressor_higher | id_esm), data = model_dat)

m9 <- 
  lmer(
     event_unpleasantness ~ 
      day + beep + gender + age +
      stressor_higher * mss_neg_score +
      stressor_higher * mss_pos_score +
      stressor_higher * mss_dis_score + 
      (stressor_higher | id_esm), data = model_dat)


m10 <-
  lmer(
     event_unpleasantness ~
      day + beep + gender + age +
      # stressor_higher * mss_neg_score +
      # stressor_higher * mss_pos_score +
      stressor_higher * mss_dis_score +
      (stressor_higher | id_esm), data = model_dat)


tab_model(
  m6, m7, m8, m9, m10,
  show.aicc = T, show.std = T)

saveRDS(m6, "models/m6.rds")
saveRDS(m7, "models/m7.rds")
saveRDS(m8, "models/m8.rds")
saveRDS(m9, "models/m9.rds")
saveRDS(m10, "models/m10.rds")


```


```{r}
plot_model(m9, type = "diag")
vif(m9)
```


